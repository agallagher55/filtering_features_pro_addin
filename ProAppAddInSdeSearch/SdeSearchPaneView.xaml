<UserControl x:Class="ProAppAddInSdeSearch.SdeSearchPaneView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"   
             xmlns:extensions="clr-namespace:ArcGIS.Desktop.Extensions;assembly=ArcGIS.Desktop.Extensions"
             xmlns:local="clr-namespace:ProAppAddInSdeSearch"
             mc:Ignorable="d" 
             d:DesignHeight="650" d:DesignWidth="340">
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <extensions:DesignOnlyResourceDictionary Source="pack://application:,,,/ArcGIS.Desktop.Framework;component\Themes\Default.xaml"/>
            </ResourceDictionary.MergedDictionaries>
            
            <!-- Bitcoin Yellow Theme Colors -->
            <Color x:Key="BitcoinYellow">#F7931A</Color>
            <Color x:Key="BitcoinYellowDark">#E8850F</Color>
            <Color x:Key="BitcoinYellowLight">#FFB347</Color>
            <Color x:Key="DarkBackground">#1A1A1A</Color>
            <Color x:Key="DarkBackgroundAlt">#242424</Color>
            <Color x:Key="DarkBorder">#3A3A3A</Color>
            <Color x:Key="LightText">#FFFFFF</Color>
            <Color x:Key="MutedText">#AAAAAA</Color>
            
            <SolidColorBrush x:Key="BitcoinYellowBrush" Color="{StaticResource BitcoinYellow}"/>
            <SolidColorBrush x:Key="BitcoinYellowDarkBrush" Color="{StaticResource BitcoinYellowDark}"/>
            <SolidColorBrush x:Key="BitcoinYellowLightBrush" Color="{StaticResource BitcoinYellowLight}"/>
            <SolidColorBrush x:Key="DarkBackgroundBrush" Color="{StaticResource DarkBackground}"/>
            <SolidColorBrush x:Key="DarkBackgroundAltBrush" Color="{StaticResource DarkBackgroundAlt}"/>
            <SolidColorBrush x:Key="DarkBorderBrush" Color="{StaticResource DarkBorder}"/>
            <SolidColorBrush x:Key="LightTextBrush" Color="{StaticResource LightText}"/>
            <SolidColorBrush x:Key="MutedTextBrush" Color="{StaticResource MutedText}"/>
            
            <BooleanToVisibilityConverter x:Key="BoolToVis"/>
            <local:InverseBoolConverter x:Key="InverseBoolConverter"/>
            <local:InverseBoolToVisibilityConverter x:Key="InverseBoolToVis"/>
            <local:NonEmptyStringToVisibilityConverter x:Key="NonEmptyToVis"/>
            
            <!-- Styled ComboBox -->
            <Style x:Key="BitcoinComboBox" TargetType="ComboBox">
                <Setter Property="Background" Value="{StaticResource DarkBackgroundAltBrush}"/>
                <Setter Property="Foreground" Value="{StaticResource LightTextBrush}"/>
                <Setter Property="BorderBrush" Value="{StaticResource DarkBorderBrush}"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="Padding" Value="6,4"/>
                <Setter Property="Template">
                    <Setter.Value>
                        <ControlTemplate TargetType="ComboBox">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="20"/>
                                </Grid.ColumnDefinitions>
                                <Border x:Name="Border" Grid.ColumnSpan="2" Background="{StaticResource DarkBackgroundAltBrush}" 
                                        BorderBrush="{StaticResource DarkBorderBrush}" BorderThickness="1" CornerRadius="2"/>
                                <TextBlock Grid.Column="0" Margin="8,4" VerticalAlignment="Center"
                                           Text="{Binding SelectedItem, RelativeSource={RelativeSource TemplatedParent}}" 
                                           Foreground="{StaticResource LightTextBrush}"
                                           TextTrimming="CharacterEllipsis"/>
                                <Path Grid.Column="1" HorizontalAlignment="Center" VerticalAlignment="Center"
                                      Data="M 0 0 L 4 4 L 8 0 Z" Fill="{StaticResource BitcoinYellowBrush}"/>
                                <ToggleButton Grid.ColumnSpan="2" Opacity="0" 
                                              IsChecked="{Binding IsDropDownOpen, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"/>
                                <Popup x:Name="PART_Popup" AllowsTransparency="True" Focusable="False"
                                       IsOpen="{TemplateBinding IsDropDownOpen}" PopupAnimation="Slide"
                                       Placement="Bottom">
                                    <Border Background="{StaticResource DarkBackgroundBrush}" 
                                            BorderBrush="{StaticResource BitcoinYellowBrush}" BorderThickness="1"
                                            MaxHeight="{TemplateBinding MaxDropDownHeight}" MinWidth="{TemplateBinding ActualWidth}">
                                        <ScrollViewer>
                                            <ItemsPresenter/>
                                        </ScrollViewer>
                                    </Border>
                                </Popup>
                            </Grid>
                            <ControlTemplate.Triggers>
                                <Trigger Property="IsMouseOver" Value="True">
                                    <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource BitcoinYellowBrush}"/>
                                </Trigger>
                                <Trigger Property="IsDropDownOpen" Value="True">
                                    <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource BitcoinYellowBrush}"/>
                                </Trigger>
                            </ControlTemplate.Triggers>
                        </ControlTemplate>
                    </Setter.Value>
                </Setter>
                <Setter Property="ItemContainerStyle">
                    <Setter.Value>
                        <Style TargetType="ComboBoxItem">
                            <Setter Property="Background" Value="{StaticResource DarkBackgroundBrush}"/>
                            <Setter Property="Foreground" Value="{StaticResource LightTextBrush}"/>
                            <Setter Property="Padding" Value="8,6"/>
                            <Setter Property="BorderThickness" Value="0"/>
                            <Style.Triggers>
                                <Trigger Property="IsHighlighted" Value="True">
                                    <Setter Property="Background" Value="{StaticResource BitcoinYellowBrush}"/>
                                    <Setter Property="Foreground" Value="{StaticResource DarkBackgroundBrush}"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </Setter.Value>
                </Setter>
            </Style>
            
            <!-- Styled TextBox -->
            <Style x:Key="BitcoinTextBox" TargetType="TextBox">
                <Setter Property="Background" Value="{StaticResource DarkBackgroundAltBrush}"/>
                <Setter Property="Foreground" Value="{StaticResource LightTextBrush}"/>
                <Setter Property="BorderBrush" Value="{StaticResource DarkBorderBrush}"/>
                <Setter Property="BorderThickness" Value="1"/>
                <Setter Property="Padding" Value="6,4"/>
                <Setter Property="CaretBrush" Value="{StaticResource BitcoinYellowBrush}"/>
                <Style.Triggers>
                    <Trigger Property="IsFocused" Value="True">
                        <Setter Property="BorderBrush" Value="{StaticResource BitcoinYellowBrush}"/>
                    </Trigger>
                </Style.Triggers>
            </Style>
            
            <!-- Styled CheckBox -->
            <Style x:Key="BitcoinCheckBox" TargetType="CheckBox">
                <Setter Property="Foreground" Value="{StaticResource MutedTextBrush}"/>
                <Setter Property="FontSize" Value="11"/>
                <Setter Property="Margin" Value="0,0,10,0"/>
                <Setter Property="VerticalContentAlignment" Value="Center"/>
            </Style>

            <!-- Primary Button -->
            <Style x:Key="BitcoinButton" TargetType="Button">
                <Setter Property="Background" Value="{StaticResource BitcoinYellowBrush}"/>
                <Setter Property="Foreground" Value="{StaticResource DarkBackgroundBrush}"/>
                <Setter Property="BorderThickness" Value="0"/>
                <Setter Property="Padding" Value="12,6"/>
                <Setter Property="Cursor" Value="Hand"/>
                <Setter Property="FontWeight" Value="SemiBold"/>
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Background" Value="{StaticResource BitcoinYellowDarkBrush}"/>
                    </Trigger>
                    <Trigger Property="IsEnabled" Value="False">
                        <Setter Property="Background" Value="{StaticResource DarkBorderBrush}"/>
                        <Setter Property="Foreground" Value="{StaticResource MutedTextBrush}"/>
                        <Setter Property="Opacity" Value="0.6"/>
                    </Trigger>
                </Style.Triggers>
            </Style>
            
            <!-- Secondary Button -->
            <Style x:Key="SecondaryButton" TargetType="Button">
                <Setter Property="Background" Value="{StaticResource DarkBorderBrush}"/>
                <Setter Property="Foreground" Value="{StaticResource LightTextBrush}"/>
                <Setter Property="BorderThickness" Value="0"/>
                <Setter Property="Padding" Value="10,6"/>
                <Setter Property="Cursor" Value="Hand"/>
                <Style.Triggers>
                    <Trigger Property="IsMouseOver" Value="True">
                        <Setter Property="Background" Value="{StaticResource BitcoinYellowDarkBrush}"/>
                        <Setter Property="Foreground" Value="{StaticResource DarkBackgroundBrush}"/>
                    </Trigger>
                    <Trigger Property="IsEnabled" Value="False">
                        <Setter Property="Opacity" Value="0.4"/>
                    </Trigger>
                </Style.Triggers>
            </Style>
        </ResourceDictionary>
    </UserControl.Resources>
    
    <Grid Background="{StaticResource DarkBackgroundBrush}">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- HEADER BAR -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <Border Grid.Row="0" Background="{StaticResource BitcoinYellowBrush}" Padding="12,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <TextBlock Grid.Column="0" Text="ðŸ”" FontSize="18" 
                           VerticalAlignment="Center" Margin="0,0,8,0"/>
                
                <TextBlock Grid.Column="1" Text="SDE Search" FontWeight="Bold" FontSize="15" 
                           VerticalAlignment="Center" Foreground="{StaticResource DarkBackgroundBrush}"/>
                
                <Button Grid.Column="2" Command="{Binding RefreshConnectionsCommand}" 
                        ToolTip="Refresh connections" Padding="8,4" 
                        Background="Transparent" BorderThickness="0" Cursor="Hand">
                    <TextBlock Text="âŸ³" FontSize="16" FontWeight="Bold" Foreground="{StaticResource DarkBackgroundBrush}"/>
                </Button>
            </Grid>
        </Border>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- CONNECTION SELECTOR + BROWSE/PASTE -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <Border Grid.Row="1" Background="{StaticResource DarkBackgroundAltBrush}" Padding="12,8" 
                BorderBrush="{StaticResource DarkBorderBrush}" BorderThickness="0,0,0,1">
            <StackPanel>
                <TextBlock Text="DATABASE CONNECTION" FontSize="10" FontWeight="SemiBold" 
                           Foreground="{StaticResource BitcoinYellowBrush}" Margin="0,0,0,6"/>
                
                <!-- Auto-detected connections dropdown -->
                <ComboBox ItemsSource="{Binding Connections}" 
                          SelectedItem="{Binding SelectedConnection, Mode=TwoWay}"
                          Style="{StaticResource BitcoinComboBox}"
                          MinHeight="30"/>
                
                <!-- Manual connection section -->
                <Expander Header="Add connection manually..." Foreground="{StaticResource MutedTextBrush}" 
                          FontSize="11" Margin="0,6,0,0" Background="Transparent" BorderThickness="0"
                          Padding="0">
                    <StackPanel Margin="0,6,0,0">
                        <!-- Browse button -->
                        <Button Command="{Binding BrowseSdeCommand}" 
                                Style="{StaticResource SecondaryButton}" 
                                HorizontalAlignment="Left" Padding="10,5" Margin="0,0,0,6">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="ðŸ“‚" FontSize="12" Margin="0,0,6,0"/>
                                <TextBlock Text="Browse for .sde file..." FontSize="11"/>
                            </StackPanel>
                        </Button>
                        
                        <!-- Paste path -->
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBox Grid.Column="0" 
                                     Text="{Binding ManualSdePath, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                     Style="{StaticResource BitcoinTextBox}" MinHeight="26"
                                     VerticalContentAlignment="Center" FontSize="11"
                                     ToolTip="Paste or type full path to .sde file"
                                     KeyDown="ManualPath_KeyDown">
                            </TextBox>
                            <Button Grid.Column="1" Command="{Binding AddManualPathCommand}" 
                                    Style="{StaticResource BitcoinButton}" Margin="4,0,0,0"
                                    Padding="8,4" ToolTip="Add this connection">
                                <TextBlock Text="Add" FontSize="11"/>
                            </Button>
                        </Grid>
                    </StackPanel>
                </Expander>
            </StackPanel>
        </Border>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- SEARCH BOX + OPTIONS -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <Border Grid.Row="2" Background="{StaticResource DarkBackgroundBrush}" Padding="12,10" 
                BorderBrush="{StaticResource DarkBorderBrush}" BorderThickness="0,0,0,1">
            <StackPanel>
                <!-- Search Input Row -->
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <TextBox Grid.Column="0" 
                             Text="{Binding SearchText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                             Style="{StaticResource BitcoinTextBox}" MinHeight="30"
                             VerticalContentAlignment="Center"
                             KeyDown="SearchBox_KeyDown">
                        <TextBox.ToolTip>
                            <TextBlock Text="Filter items by name or metadata.&#x0a;Press Enter or click Filter."/>
                        </TextBox.ToolTip>
                    </TextBox>
                    
                    <Button Grid.Column="1" Command="{Binding SearchCommand}" 
                            Style="{StaticResource BitcoinButton}" Margin="6,0,0,0"
                            MinHeight="30">
                        <TextBlock Text="Filter"/>
                    </Button>
                    
                    <Button Grid.Column="2" Command="{Binding ClearCommand}" 
                            Style="{StaticResource SecondaryButton}" Margin="4,0,0,0"
                            MinHeight="30" ToolTip="Clear filter">
                        <TextBlock Text="âœ•" FontSize="12"/>
                    </Button>
                </Grid>
                
                <!-- Search mode toggles -->
                <WrapPanel Margin="0,8,0,0">
                    <CheckBox Content="Name" IsChecked="{Binding SearchByName}" 
                              Style="{StaticResource BitcoinCheckBox}"/>
                    <CheckBox Content="Metadata" IsChecked="{Binding SearchByMetadata}" 
                              Style="{StaticResource BitcoinCheckBox}"
                              ToolTip="Search metadata (loaded when you click into item details)"/>
                </WrapPanel>
            </StackPanel>
        </Border>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- TYPE FILTERS -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <Border Grid.Row="3" Background="{StaticResource DarkBackgroundAltBrush}" Padding="12,6" 
                BorderBrush="{StaticResource DarkBorderBrush}" BorderThickness="0,0,0,1">
            <WrapPanel>
                <TextBlock Text="Show:" Foreground="{StaticResource MutedTextBrush}" FontSize="11" 
                           VerticalAlignment="Center" Margin="0,0,8,0"/>
                <CheckBox Content="ðŸ“ Feature Classes" IsChecked="{Binding ShowFeatureClasses}" 
                          Style="{StaticResource BitcoinCheckBox}"/>
                <CheckBox Content="ðŸ“‹ Tables" IsChecked="{Binding ShowTables}" 
                          Style="{StaticResource BitcoinCheckBox}"/>
                <CheckBox Content="ðŸ“ Feature Datasets" IsChecked="{Binding ShowFeatureDatasets}" 
                          Style="{StaticResource BitcoinCheckBox}"/>
            </WrapPanel>
        </Border>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- PROGRESS BAR (visible during loading) -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <Border Grid.Row="4" Background="{StaticResource DarkBackgroundBrush}" 
                Visibility="{Binding IsSearching, Converter={StaticResource BoolToVis}}"
                Padding="12,8"
                BorderBrush="{StaticResource DarkBorderBrush}" BorderThickness="0,0,0,1">
            <StackPanel>
                <ProgressBar IsIndeterminate="True" Height="3" 
                             Foreground="{StaticResource BitcoinYellowBrush}" 
                             Background="{StaticResource DarkBorderBrush}"
                             BorderThickness="0"
                             Margin="0,0,0,6"/>
                <TextBlock Text="{Binding ProgressText}" 
                           FontSize="11" Foreground="{StaticResource BitcoinYellowLightBrush}"
                           TextWrapping="Wrap"/>
            </StackPanel>
        </Border>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- MAIN CONTENT AREA -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <Grid Grid.Row="5">
            
            <!-- â•â•â•â•â•â•â•â•â•â• RESULTS LIST VIEW â•â•â•â•â•â•â•â•â•â• -->
            <ScrollViewer VerticalScrollBarVisibility="Auto" 
                          Visibility="{Binding ShowResultsList, Converter={StaticResource BoolToVis}}">
                <ItemsControl ItemsSource="{Binding SearchResults}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <Border Padding="12,10" 
                                    BorderBrush="{StaticResource DarkBorderBrush}" BorderThickness="0,0,0,1"
                                    Cursor="Hand" MouseLeftButtonUp="ResultItem_Click">
                                <Border.Style>
                                    <Style TargetType="Border">
                                        <Setter Property="Background" Value="{StaticResource DarkBackgroundBrush}"/>
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="{StaticResource DarkBackgroundAltBrush}"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </Border.Style>
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <!-- Type Icon -->
                                    <TextBlock Grid.Column="0" Grid.RowSpan="3" 
                                               Text="{Binding TypeIcon}" FontSize="22" 
                                               VerticalAlignment="Center" Margin="0,0,10,0"/>
                                    
                                    <!-- Dataset Name -->
                                    <TextBlock Grid.Column="1" Grid.Row="0" 
                                               Text="{Binding SimpleName}" 
                                               Foreground="{StaticResource LightTextBrush}"
                                               FontSize="13" FontWeight="SemiBold"
                                               TextTrimming="CharacterEllipsis"
                                               ToolTip="{Binding Name}"/>
                                    
                                    <!-- Subtitle -->
                                    <TextBlock Grid.Column="1" Grid.Row="1" 
                                               Text="{Binding Subtitle}" 
                                               Foreground="{StaticResource MutedTextBrush}"
                                               FontSize="11" Margin="0,2,0,0"
                                               TextTrimming="CharacterEllipsis"/>
                                    
                                    <!-- Metadata snippet (only if loaded) -->
                                    <TextBlock Grid.Column="1" Grid.Row="2" Grid.ColumnSpan="2"
                                               Text="{Binding MetadataSnippet}" 
                                               Foreground="{StaticResource BitcoinYellowLightBrush}"
                                               FontSize="10" Margin="0,4,0,0"
                                               TextWrapping="Wrap" MaxHeight="36"
                                               Visibility="{Binding MetadataSnippet, Converter={StaticResource NonEmptyToVis}}"/>
                                    
                                    <!-- Add to map button -->
                                    <Button Grid.Column="2" Grid.Row="0" Grid.RowSpan="2"
                                            Visibility="{Binding CanAddToMap, Converter={StaticResource BoolToVis}}"
                                            ToolTip="Add to active map"
                                            Padding="6,4" Margin="6,0,0,0"
                                            VerticalAlignment="Center"
                                            Click="AddToMapButton_Click">
                                        <Button.Style>
                                            <Style TargetType="Button">
                                                <Setter Property="Background" Value="Transparent"/>
                                                <Setter Property="BorderThickness" Value="1"/>
                                                <Setter Property="BorderBrush" Value="{StaticResource DarkBorderBrush}"/>
                                                <Setter Property="Cursor" Value="Hand"/>
                                                <Style.Triggers>
                                                    <Trigger Property="IsMouseOver" Value="True">
                                                        <Setter Property="BorderBrush" Value="{StaticResource BitcoinYellowBrush}"/>
                                                        <Setter Property="Background" Value="{StaticResource DarkBackgroundAltBrush}"/>
                                                    </Trigger>
                                                </Style.Triggers>
                                            </Style>
                                        </Button.Style>
                                        <TextBlock Text="ï¼‹" FontSize="16" Foreground="{StaticResource BitcoinYellowBrush}"/>
                                    </Button>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </ScrollViewer>
            
            <!-- â•â•â•â•â•â•â•â•â•â• DETAIL VIEW â•â•â•â•â•â•â•â•â•â• -->
            <ScrollViewer VerticalScrollBarVisibility="Auto" 
                          Visibility="{Binding ShowDetails, Converter={StaticResource BoolToVis}}">
                <StackPanel>
                    <!-- Back button + item header -->
                    <Border Background="{StaticResource DarkBackgroundAltBrush}" Padding="12,10"
                            BorderBrush="{StaticResource DarkBorderBrush}" BorderThickness="0,0,0,1">
                        <StackPanel>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <Button Grid.Column="0" Command="{Binding BackToResultsCommand}"
                                        Style="{StaticResource SecondaryButton}" Margin="0,0,8,0"
                                        Padding="8,4">
                                    <TextBlock Text="â—€ Back" FontSize="11"/>
                                </Button>
                                
                                <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                    <TextBlock Text="{Binding SelectedResult.SimpleName}" 
                                               FontSize="14" FontWeight="Bold" 
                                               Foreground="{StaticResource LightTextBrush}"
                                               TextTrimming="CharacterEllipsis"/>
                                    <TextBlock Text="{Binding SelectedResult.Subtitle}" 
                                               FontSize="11" 
                                               Foreground="{StaticResource MutedTextBrush}"/>
                                </StackPanel>
                                
                                <Button Grid.Column="2" Command="{Binding CopyPathCommand}"
                                        Style="{StaticResource SecondaryButton}" Margin="4,0"
                                        Padding="8,4" ToolTip="Copy full path">
                                    <TextBlock Text="ðŸ“‹" FontSize="12"/>
                                </Button>
                                
                                <Button Grid.Column="3" Command="{Binding AddToMapCommand}"
                                        Style="{StaticResource BitcoinButton}" Padding="8,4"
                                        Visibility="{Binding SelectedResult.CanAddToMap, Converter={StaticResource BoolToVis}}">
                                    <TextBlock Text="ï¼‹ Add to Map" FontSize="11"/>
                                </Button>
                            </Grid>
                            
                            <!-- Loading indicator for details -->
                            <ProgressBar IsIndeterminate="True" Height="2" 
                                         Foreground="{StaticResource BitcoinYellowBrush}" 
                                         Background="Transparent" BorderThickness="0"
                                         Margin="0,6,0,0"
                                         Visibility="{Binding IsLoadingDetails, Converter={StaticResource BoolToVis}}"/>
                        </StackPanel>
                    </Border>
                    
                    <!-- Metadata Section -->
                    <Border Background="{StaticResource DarkBackgroundAltBrush}" Padding="12,8" Margin="0,1,0,0"
                            BorderBrush="{StaticResource DarkBorderBrush}" BorderThickness="0,0,0,1">
                        <TextBlock Text="METADATA" FontSize="10" FontWeight="SemiBold" 
                                   Foreground="{StaticResource BitcoinYellowBrush}"/>
                    </Border>
                    <Border Background="{StaticResource DarkBackgroundBrush}" Padding="12,8"
                            BorderBrush="{StaticResource DarkBorderBrush}" BorderThickness="0,0,0,1">
                        <TextBlock Text="{Binding DetailMetadata}" 
                                   Foreground="{StaticResource LightTextBrush}"
                                   FontSize="11" TextWrapping="Wrap" LineHeight="18"/>
                    </Border>
                    
                    <!-- Fields Section -->
                    <Border Background="{StaticResource DarkBackgroundAltBrush}" Padding="12,8" Margin="0,1,0,0"
                            BorderBrush="{StaticResource DarkBorderBrush}" BorderThickness="0,0,0,1">
                        <TextBlock Text="FIELDS" FontSize="10" FontWeight="SemiBold" 
                                   Foreground="{StaticResource BitcoinYellowBrush}"/>
                    </Border>
                    
                    <ItemsControl ItemsSource="{Binding DetailFields}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border Padding="12,6" 
                                        BorderBrush="{StaticResource DarkBorderBrush}" BorderThickness="0,0,0,1">
                                    <Border.Style>
                                        <Style TargetType="Border">
                                            <Setter Property="Background" Value="{StaticResource DarkBackgroundBrush}"/>
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="{StaticResource DarkBackgroundAltBrush}"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </Border.Style>
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        
                                        <TextBlock Grid.Column="0" Grid.RowSpan="3" 
                                                   Text="{Binding TypeIcon}" FontSize="11" 
                                                   VerticalAlignment="Top" Margin="0,2,8,0"
                                                   Foreground="{StaticResource MutedTextBrush}"/>
                                        
                                        <TextBlock Grid.Column="1" Grid.Row="0" 
                                                   Text="{Binding AliasName}" 
                                                   Foreground="{StaticResource LightTextBrush}"
                                                   FontSize="12" FontWeight="SemiBold"
                                                   ToolTip="{Binding Name}"/>
                                        
                                        <TextBlock Grid.Column="1" Grid.Row="1" 
                                                   Text="{Binding FieldSummary}" 
                                                   Foreground="{StaticResource MutedTextBrush}"
                                                   FontSize="10"/>
                                        
                                        <TextBlock Grid.Column="1" Grid.Row="2" 
                                                   Text="{Binding DomainInfo}" 
                                                   Foreground="{StaticResource BitcoinYellowLightBrush}"
                                                   FontSize="10" TextWrapping="Wrap"
                                                   Visibility="{Binding HasDomain, Converter={StaticResource BoolToVis}}"
                                                   Margin="0,2,0,0"/>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </StackPanel>
            </ScrollViewer>
        </Grid>

        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <!-- STATUS BAR -->
        <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
        <Border Grid.Row="7" Background="{StaticResource DarkBackgroundAltBrush}" Padding="12,6" 
                BorderBrush="{StaticResource DarkBorderBrush}" BorderThickness="0,1,0,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" Text="{Binding StatusText}" 
                           FontSize="11" Foreground="{StaticResource MutedTextBrush}"
                           TextTrimming="CharacterEllipsis" VerticalAlignment="Center"/>
                <TextBlock Grid.Column="1" FontSize="11" Foreground="{StaticResource BitcoinYellowLightBrush}"
                           VerticalAlignment="Center" Margin="8,0,0,0">
                    <TextBlock.Style>
                        <Style TargetType="TextBlock">
                            <Setter Property="Text" Value="{Binding ResultCount, StringFormat='{}{0} items'}"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding ResultCount}" Value="0">
                                    <Setter Property="Visibility" Value="Collapsed"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </TextBlock.Style>
                </TextBlock>
            </Grid>
        </Border>
    </Grid>
</UserControl>
